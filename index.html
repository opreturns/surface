
<!doctype html>
<html lang="en">
<head>
  <script type="module" src="/@vite/client"></script>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>OP_RETURN Attack Surface Demo</title>
<style>
  :root {
    --bg: #0a0e17;
    --fg: #e6edf3;
    --muted: #7d8590;
    --card-bg: #161b22;
    --accent: #f7931a;
    --accent-dim: rgba(247, 147, 26, 0.1);
    --danger: #ff6b6b;
    --gray: #4a5568;
    --border: #30363d;
  }

  * { box-sizing: border-box; }

  body {
    margin: 0;
    padding: 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
    background: var(--bg);
    color: var(--fg);
    line-height: 1.6;
  }

  .container {
    max-width: 900px;
    margin: 0 auto;
    padding: 32px 20px;
  }

  /* Header */
  header {
    text-align: center;
    margin-bottom: 48px;
  }

  h1 {
    font-size: 36px;
    font-weight: 700;
    margin: 0 0 12px;
    letter-spacing: -0.03em;
  }

  .subtitle {
    font-size: 17px;
    color: var(--muted);
    max-width: 700px;
    margin: 0 auto 32px;
  }

  /* Gallery metaphor callout */
  .gallery-box {
    background: linear-gradient(135deg, #1a1f2e 0%, #0f1420 100%);
    border: 3px solid var(--accent);
    border-radius: 16px;
    padding: 28px;
    margin: 32px 0;
    box-shadow: 0 0 40px rgba(247, 147, 26, 0.2);
    position: relative;
    overflow: hidden;
  }

  .gallery-box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--accent) 0%, #ffa500 100%);
  }

  .gallery-title {
    font-size: 22px;
    font-weight: 700;
    color: var(--accent);
    margin: 0 0 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
  }

  .emoji { font-size: 24px; }

  .gallery-subtitle {
    font-size: 18px;
    text-align: center;
    margin: 0 0 24px;
    color: var(--fg);
    font-weight: 500;
  }

  .gallery-desc {
    font-size: 16px;
    text-align: center;
    color: var(--muted);
    margin: 0 0 28px;
  }

  /* Comparison grid */
  .comparison-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 24px;
  }

  @media (max-width: 650px) {
    .comparison-grid {
      grid-template-columns: 1fr;
    }
  }

  .compare-card {
    padding: 20px;
    border-radius: 10px;
    border: 2px solid;
  }

  .gallery-card {
    background: var(--accent-dim);
    border-color: var(--accent);
  }

  .drawer-card {
    background: rgba(74, 85, 104, 0.1);
    border-color: var(--gray);
  }

  .compare-card h3 {
    margin: 0 0 12px;
    font-size: 15px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .gallery-card h3 { color: var(--accent); }
  .drawer-card h3 { color: #9ca3af; }

  .compare-card p {
    margin: 0;
    font-size: 14px;
    line-height: 1.6;
    color: var(--fg);
  }

  /* Main demo section */
  .demo-section {
    margin: 48px 0;
  }

  .demo-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
    flex-wrap: wrap;
    gap: 12px;
  }

  h2 {
    font-size: 20px;
    font-weight: 700;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: var(--card-bg);
    border: 1px solid var(--border);
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 12px;
    color: var(--muted);
    font-family: ui-monospace, monospace;
  }

  button {
    background: var(--card-bg);
    color: var(--fg);
    border: 1px solid var(--border);
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 600;
    transition: all 0.2s;
  }

  button:hover {
    background: #21262d;
    border-color: var(--accent);
  }

  button:active {
    transform: translateY(1px);
  }

  /* The rendered display - "on the wall" */
  .gallery-display {
    background: var(--card-bg);
    border: 3px solid var(--accent);
    border-radius: 16px;
    padding: 32px;
    text-align: center;
    margin: 24px 0;
    box-shadow:
      0 0 30px rgba(247, 147, 26, 0.25),
      inset 0 1px 0 rgba(255, 255, 255, 0.03);
    position: relative;
  }

  .gallery-display::after {
    content: 'üñºÔ∏è Public Gallery Display';
    position: absolute;
    top: -12px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg);
    padding: 4px 16px;
    font-size: 12px;
    font-weight: 700;
    color: var(--accent);
    border: 2px solid var(--accent);
    border-radius: 20px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .rendered-img {
    max-width: 200px;
    height: auto;
    border-radius: 8px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  }

  .uri-info {
    margin-top: 20px;
    padding: 12px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    font-size: 12px;
    color: var(--muted);
    word-break: break-all;
  }

  /* JSON display */
  .json-container {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin: 24px 0;
  }

  pre {
    margin: 0;
    padding: 0;
    overflow: auto;
    font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
    font-size: 13px;
    line-height: 1.6;
    color: var(--fg);
  }

  /* Explanation section */
  .explanation {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 28px;
    margin: 32px 0;
  }

  .explanation h2 {
    margin: 0 0 20px;
  }

  .explanation ul {
    margin: 0;
    padding-left: 24px;
  }

  .explanation li {
    margin-bottom: 16px;
    line-height: 1.7;
  }

  .explanation strong {
    color: var(--accent);
    font-weight: 700;
  }

  .explanation code {
    background: rgba(255, 255, 255, 0.05);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 13px;
    font-family: ui-monospace, monospace;
  }

  .note {
    margin-top: 20px;
    padding: 16px;
    background: rgba(255, 107, 107, 0.08);
    border-left: 3px solid var(--danger);
    border-radius: 6px;
    font-size: 14px;
    color: var(--muted);
  }

  .highlight-accent { color: var(--accent); }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>OP_RETURN <span class="highlight-accent">Attack Surface</span> Demo</h1>
    <p class="subtitle">
      How Bitcoin's OP_RETURN creates a "public gallery" for arbitrary data,
      expanding the attack surface beyond simple blockchain storage.
    </p>
  </header>

  <!-- Gallery metaphor -->
  <div class="gallery-box">
    <div class="gallery-title">
      <span class="emoji">üñºÔ∏è</span>
      <span>Gallery vs. Drawer</span>
      <span class="emoji">üîí</span>
    </div>

    <p class="gallery-subtitle">
      <strong>OP_RETURN</strong> hangs the image on the wall. <strong>Obfuscation</strong> stuffs it in a drawer.
    </p>

    <p class="gallery-desc">
      The bytes exist in both cases, but <strong>exposure matters</strong>:
      one is sanctioned display, the other tolerated abuse.
    </p>

    <div class="comparison-grid">
      <div class="compare-card gallery-card">
        <h3><span class="emoji">üéØ</span> OP_RETURN: Public Gallery</h3>
        <p>
          <strong>Sanctioned display.</strong> Standard RPC/REST APIs expose data URIs.
          Any HTTP client can fetch, parse, and render instantly. Universal content serving.
        </p>
      </div>

      <div class="compare-card drawer-card">
        <h3><span class="emoji">üóÑÔ∏è</span> Obfuscation: Hidden Drawer</h3>
        <p>
          <strong>Tolerated abuse.</strong> Data exists but requires specialized knowledge
          to find and extract. Higher barrier to access, lower attack surface.
        </p>
      </div>
    </div>
  </div>

  <!-- Demo: Rendered output first (the point) -->
  <section class="demo-section">
    <div class="demo-header">
      <h2><span class="emoji">‚ú®</span> Self-Extracting Content</h2>
      <button id="copyData">Copy Data URI</button>
    </div>

    <div class="gallery-display">
      <img id="preview" class="rendered-img" alt="Rendered Bitcoin symbol from OP_RETURN data URI" />
      <div class="uri-info">
        <div style="margin-bottom: 8px; font-weight: 600; color: var(--fg);">
          Data URI: <span id="length"></span>
        </div>
        <div id="dataSnippet"></div>
      </div>
    </div>
  </section>

  <!-- Then show the JSON source -->
  <section class="demo-section">
    <div class="demo-header">
      <h2><span class="emoji">üìã</span> Bitcoin RPC JSON Response</h2>
      <span class="badge">
        <code>getrawtransaction &lt;txid&gt; true</code>
      </span>
      <button id="copyJson">Copy JSON</button>
    </div>

    <div class="json-container">
      <pre id="jsonView"></pre>
    </div>

    <script type="application/json" id="txjson">
{
  "txid": "exampletxid000000000000000000000000000000000000000000000000000000",
  "hash": "examplehash000000000000000000000000000000000000000000000000000000",
  "version": 2,
  "size": 225,
  "vsize": 144,
  "locktime": 0,
  "vin": [
    {
      "txid": "prevtxid000000000000000000000000000000000000000000000000000000",
      "vout": 0,
      "scriptSig": { "asm": "", "hex": "" },
      "sequence": 4294967295
    }
  ],
  "vout": [
    {
      "value": 0.00000000,
      "n": 0,
      "scriptPubKey": {
        "asm": "OP_RETURN data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMjgnIGhlaWdodD0nMTI4Jz4KICA8cmVjdCB3aWR0aD0nMTAwJScgaGVpZ2h0PScxMDAlJyBmaWxsPScjZjc5MzFhJy8+CiAgPHRleHQgeD0nNTAlJyB5PSc1OCUnIHRleHQtYW5jaG9yPSdtaWRkbGUnIGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtc2l6ZT0nNzInIGZvbnQtZmFtaWx5PSdzYW5zLXNlcmlmJyBmaWxsPScjZmZmJz7igr88L3RleHQ+Cjwvc3ZnPg==",
        "type": "nulldata"
      }
    },
    {
      "value": 0.00100000,
      "n": 1,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 <pubKeyHash> OP_EQUALVERIFY OP_CHECKSIG",
        "reqSigs": 1,
        "type": "pubkeyhash",
        "addresses": ["1ExampleBitcoinAddressxxxxxxxxxxxxxxxx"]
      }
    }
  ]
}
    </script>
  </section>

  <!-- Explanation -->
  <div class="explanation">
    <h2><span class="emoji">‚ö†Ô∏è</span> Why This Matters</h2>
    <ul>
      <li>
        <strong>Self-extracting by design:</strong> The <code>asm</code> field embeds a Data URI
        directly after <code>OP_RETURN</code>. Any HTTP-capable client can fetch this JSON,
        parse the string, and set it as <code>&lt;img src="..."&gt;</code> to render instantly.
      </li>
      <li>
        <strong>Zero specialized tooling:</strong> Just JSON + the web's standard <code>data:</code> scheme.
        This makes content universally accessible to any browser, app, or script.
      </li>
      <li>
        <strong>Expanded attack surface:</strong> Large OP_RETURN payloads + RPC/REST bridges =
        universal content serving. Unlike obfuscated data hidden in witness or P2SH scripts,
        OP_RETURN data is explicitly designed for retrieval and display.
      </li>
      <li>
        <strong>Liability difference:</strong> When node operators expose OP_RETURN via standard APIs,
        they become de facto content hosts‚Äînot just blockchain validators. The "public gallery"
        makes moderation impossible without protocol changes.
      </li>
    </ul>

    <div class="note">
      <strong>Note:</strong> This demo uses a benign SVG (orange background + Bitcoin symbol "‚Çø").
      Real transactions typically store hex bytes, but once converted to a Data URI,
      any system that speaks HTTP can render it. The issue isn't <em>what's</em> stored‚Äîit's
      how easily it's <em>surfaced</em>.
    </div>
  </div>
</div>

<script>
(function () {
  const txEl = document.getElementById('txjson');
  const jsonView = document.getElementById('jsonView');
  const copyJsonBtn = document.getElementById('copyJson');
  const copyDataBtn = document.getElementById('copyData');
  const img = document.getElementById('preview');
  const dataSnippet = document.getElementById('dataSnippet');
  const lengthEl = document.getElementById('length');

  const tx = JSON.parse(txEl.textContent);
  jsonView.textContent = JSON.stringify(tx, null, 2);

  // Extract Data URI from OP_RETURN
  function extractDataUri(tx) {
    try {
      const asm = tx.vout[0].scriptPubKey.asm || "";
      const parts = asm.split(/\s+/);
      return parts.find(p => p.startsWith("data:")) || "";
    } catch {
      return "";
    }
  }

  const dataUri = extractDataUri(tx);
  if (dataUri) {
    img.src = dataUri;
    const snippet = dataUri.slice(0, 100);
    dataSnippet.textContent = snippet + (dataUri.length > 100 ? '...' : '');
    lengthEl.textContent = `${dataUri.length} chars`;
  } else {
    document.querySelector('.gallery-display').innerHTML =
      '<p style="color: var(--danger);">No data URI found in OP_RETURN.</p>';
  }

  // Copy handlers
  copyJsonBtn.addEventListener('click', async () => {
    await navigator.clipboard.writeText(jsonView.textContent);
    const original = copyJsonBtn.textContent;
    copyJsonBtn.textContent = '‚úì Copied!';
    setTimeout(() => copyJsonBtn.textContent = original, 1500);
  });

  copyDataBtn.addEventListener('click', async () => {
    if (!dataUri) return;
    await navigator.clipboard.writeText(dataUri);
    const original = copyDataBtn.textContent;
    copyDataBtn.textContent = '‚úì Copied!';
    setTimeout(() => copyDataBtn.textContent = original, 1500);
  });
})();
</script>
</body>
</html>
